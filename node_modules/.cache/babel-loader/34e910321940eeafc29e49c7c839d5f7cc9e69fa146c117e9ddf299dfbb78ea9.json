{"ast":null,"code":"var _jsxFileName = \"/home/kanga_prog_unix/hbnb_v2/frontend/src/pages/EditPlace.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport API from \"../services/api\";\nimport PlaceForm from \"../components/place/PlaceForm\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function EditPlace() {\n  _s();\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const [place, setPlace] = useState(null);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    API.get(`/places/${id}/`).then(res => setPlace(res.data)).catch(err => {\n      console.error(err);\n      alert(\"Impossible de charger le lieu.\");\n    }).finally(() => setLoading(false));\n  }, [id]);\n  const handleUpdate = async data => {\n    try {\n      // Étape 1 : update JSON\n      const payload = {\n        name: data.name,\n        description: data.description,\n        price_by_night: Number(data.price_by_night),\n        location: data.location,\n        country: data.country,\n        town: data.town,\n        latitude: data.latitude ? Number(data.latitude) : null,\n        longitude: data.longitude ? Number(data.longitude) : null,\n        amenity_ids: data.amenities || []\n      };\n      await API.put(`/places/${id}/`, payload, {\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      });\n\n      // Étape 2 : upload des nouvelles images\n      if (data.images && data.images.length > 0) {\n        for (const file of data.images) {\n          const formData = new FormData();\n          formData.append(\"file\", file);\n          await API.post(`/places/${id}/images`, formData, {\n            headers: {\n              \"Content-Type\": \"multipart/form-data\"\n            }\n          });\n        }\n      }\n      alert(\"Lieu mis à jour !\");\n      navigate(`/places/${id}`);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(\"Erreur mise à jour :\", err);\n      alert(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || \"Erreur lors de la mise à jour\");\n    }\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Chargement...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 23\n  }, this);\n  if (!place) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Lieu introuvable.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 22\n  }, this);\n  return /*#__PURE__*/_jsxDEV(PlaceForm, {\n    onSubmit: handleUpdate,\n    initialData: place\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 10\n  }, this);\n}\n_s(EditPlace, \"SkxWHHP90eT/JfAfkn7eKzmpEcc=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = EditPlace;\nvar _c;\n$RefreshReg$(_c, \"EditPlace\");","map":{"version":3,"names":["useEffect","useState","useParams","useNavigate","API","PlaceForm","jsxDEV","_jsxDEV","EditPlace","_s","id","navigate","place","setPlace","loading","setLoading","get","then","res","data","catch","err","console","error","alert","finally","handleUpdate","payload","name","description","price_by_night","Number","location","country","town","latitude","longitude","amenity_ids","amenities","put","headers","images","length","file","formData","FormData","append","post","_err$response","_err$response$data","response","message","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","initialData","_c","$RefreshReg$"],"sources":["/home/kanga_prog_unix/hbnb_v2/frontend/src/pages/EditPlace.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport API from \"../services/api\";\nimport PlaceForm from \"../components/place/PlaceForm\";\n\nexport default function EditPlace() {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [place, setPlace] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    API.get(`/places/${id}/`)\n      .then((res) => setPlace(res.data))\n      .catch((err) => {\n        console.error(err);\n        alert(\"Impossible de charger le lieu.\");\n      })\n      .finally(() => setLoading(false));\n  }, [id]);\n\n  const handleUpdate = async (data) => {\n  try {\n    // Étape 1 : update JSON\n    const payload = {\n      name: data.name,\n      description: data.description,\n      price_by_night: Number(data.price_by_night),\n      location: data.location,\n      country: data.country,\n      town: data.town,\n      latitude: data.latitude ? Number(data.latitude) : null,\n      longitude: data.longitude ? Number(data.longitude) : null,\n      amenity_ids: data.amenities || [],\n    };\n\n    await API.put(`/places/${id}/`, payload, {\n      headers: { \"Content-Type\": \"application/json\" },\n    });\n\n    // Étape 2 : upload des nouvelles images\n    if (data.images && data.images.length > 0) {\n      for (const file of data.images) {\n        const formData = new FormData();\n        formData.append(\"file\", file);\n        await API.post(`/places/${id}/images`, formData, {\n          headers: { \"Content-Type\": \"multipart/form-data\" },\n        });\n      }\n    }\n\n    alert(\"Lieu mis à jour !\");\n    navigate(`/places/${id}`);\n  } catch (err) {\n    console.error(\"Erreur mise à jour :\", err);\n    alert(err.response?.data?.message || \"Erreur lors de la mise à jour\");\n  }\n};\n\n\n  if (loading) return <p>Chargement...</p>;\n  if (!place) return <p>Lieu introuvable.</p>;\n\n  return <PlaceForm onSubmit={handleUpdate} initialData={place} />;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}