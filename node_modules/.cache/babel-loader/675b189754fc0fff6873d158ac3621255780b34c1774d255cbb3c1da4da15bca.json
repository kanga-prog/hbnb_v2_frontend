{"ast":null,"code":"// src/pages/ResetPasswordForm.jsx\nimport{useState}from\"react\";import API from\"../services/api\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ResetPasswordForm(_ref){let{mode=\"forgot\",userEmail=\"\",onCancel}=_ref;const[email,setEmail]=useState(userEmail);const[code,setCode]=useState(\"\");const[newPassword,setNewPassword]=useState(\"\");const[confirmPassword,setConfirmPassword]=useState(\"\");const[message,setMessage]=useState(\"\");const[step,setStep]=useState(\"request\");// \"request\" → \"reset\"\nconst[loading,setLoading]=useState(false);// Étape 1 : envoi du code\nconst handleForgotSubmit=async e=>{e.preventDefault();if(!email)return setMessage(\"Email requis\");try{setLoading(true);await API.post(\"/auth/forgot_password\",{email});setMessage(\"Code envoyé à votre email\");setStep(\"reset\");}catch(err){var _err$response,_err$response$data;console.error(err);setMessage(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.msg)||\"Erreur lors de la requête\");}finally{setLoading(false);}};// Étape 2 : validation du code + changement de mot de passe\nconst handleResetSubmit=async e=>{e.preventDefault();if(!email||!code||!newPassword||!confirmPassword)return setMessage(\"Tous les champs sont requis\");if(newPassword!==confirmPassword)return setMessage(\"Les mots de passe ne correspondent pas\");try{setLoading(true);const res=await API.post(\"/auth/reset_password\",{email,code,new_password:newPassword});setMessage(res.data.msg||\"Mot de passe mis à jour avec succès\");// Optionnel : reset formulaire ou retour login\nsetStep(\"request\");setEmail(\"\");setCode(\"\");setNewPassword(\"\");setConfirmPassword(\"\");}catch(err){var _err$response2,_err$response2$data;console.error(err);setMessage(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.msg)||\"Erreur lors de la réinitialisation\");}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:step===\"request\"?handleForgotSubmit:handleResetSubmit,style:{maxWidth:\"400px\",margin:\"0 auto\",padding:\"1rem\",border:\"1px solid #ccc\",borderRadius:\"8px\"},children:[/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:\"center\"},children:step===\"request\"?\"Mot de passe oublié\":\"Réinitialiser le mot de passe\"}),message&&/*#__PURE__*/_jsx(\"p\",{style:{color:\"red\",textAlign:\"center\"},children:message}),step===\"request\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:email,onChange:e=>setEmail(e.target.value),required:true})]}),step===\"reset\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Code re\\xE7u par email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:code,onChange:e=>setCode(e.target.value),placeholder:\"Entrez le code re\\xE7u\",required:true}),/*#__PURE__*/_jsx(\"label\",{children:\"Nouveau mot de passe\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:newPassword,onChange:e=>setNewPassword(e.target.value),required:true}),/*#__PURE__*/_jsx(\"label\",{children:\"Confirmer mot de passe\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:confirmPassword,onChange:e=>setConfirmPassword(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,style:{marginTop:\"1rem\",width:\"100%\"},children:loading?\"En cours...\":step===\"request\"?\"Envoyer le code\":\"Réinitialiser le mot de passe\"}),onCancel&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onCancel,style:{marginTop:\"0.5rem\",width:\"100%\",backgroundColor:\"#ccc\",color:\"#000\",padding:\"0.5rem\",borderRadius:\"8px\"},children:\"Retour \\xE0 la connexion\"})]});}","map":{"version":3,"names":["useState","API","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ResetPasswordForm","_ref","mode","userEmail","onCancel","email","setEmail","code","setCode","newPassword","setNewPassword","confirmPassword","setConfirmPassword","message","setMessage","step","setStep","loading","setLoading","handleForgotSubmit","e","preventDefault","post","err","_err$response","_err$response$data","console","error","response","data","msg","handleResetSubmit","res","new_password","_err$response2","_err$response2$data","onSubmit","style","maxWidth","margin","padding","border","borderRadius","children","textAlign","color","type","value","onChange","target","required","placeholder","disabled","marginTop","width","onClick","backgroundColor"],"sources":["/home/kanga_prog_unix/hbnb_v2_frontend/src/pages/ResetPasswordForm.jsx"],"sourcesContent":["// src/pages/ResetPasswordForm.jsx\nimport { useState } from \"react\";\nimport API from \"../services/api\";\n\nexport default function ResetPasswordForm({ mode = \"forgot\", userEmail = \"\", onCancel }) {\n  const [email, setEmail] = useState(userEmail);\n  const [code, setCode] = useState(\"\");\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [message, setMessage] = useState(\"\");\n  const [step, setStep] = useState(\"request\"); // \"request\" → \"reset\"\n  const [loading, setLoading] = useState(false);\n\n  // Étape 1 : envoi du code\n  const handleForgotSubmit = async (e) => {\n    e.preventDefault();\n    if (!email) return setMessage(\"Email requis\");\n\n    try {\n      setLoading(true);\n      await API.post(\"/auth/forgot_password\", { email });\n      setMessage(\"Code envoyé à votre email\");\n      setStep(\"reset\");\n    } catch (err) {\n      console.error(err);\n      setMessage(err.response?.data?.msg || \"Erreur lors de la requête\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Étape 2 : validation du code + changement de mot de passe\n  const handleResetSubmit = async (e) => {\n    e.preventDefault();\n    if (!email || !code || !newPassword || !confirmPassword)\n      return setMessage(\"Tous les champs sont requis\");\n    if (newPassword !== confirmPassword)\n      return setMessage(\"Les mots de passe ne correspondent pas\");\n\n    try {\n      setLoading(true);\n      const res = await API.post(\"/auth/reset_password\", {\n        email,\n        code,\n        new_password: newPassword\n      });\n      setMessage(res.data.msg || \"Mot de passe mis à jour avec succès\");\n      // Optionnel : reset formulaire ou retour login\n      setStep(\"request\");\n      setEmail(\"\");\n      setCode(\"\");\n      setNewPassword(\"\");\n      setConfirmPassword(\"\");\n    } catch (err) {\n      console.error(err);\n      setMessage(err.response?.data?.msg || \"Erreur lors de la réinitialisation\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form\n      onSubmit={step === \"request\" ? handleForgotSubmit : handleResetSubmit}\n      style={{\n        maxWidth: \"400px\",\n        margin: \"0 auto\",\n        padding: \"1rem\",\n        border: \"1px solid #ccc\",\n        borderRadius: \"8px\"\n      }}\n    >\n      <h2 style={{ textAlign: \"center\" }}>\n        {step === \"request\" ? \"Mot de passe oublié\" : \"Réinitialiser le mot de passe\"}\n      </h2>\n\n      {message && <p style={{ color: \"red\", textAlign: \"center\" }}>{message}</p>}\n\n      {/* Étape 1 : email */}\n      {step === \"request\" && (\n        <>\n          <label>Email</label>\n          <input\n            type=\"email\"\n            value={email}\n            onChange={(e) => setEmail(e.target.value)}\n            required\n          />\n        </>\n      )}\n\n      {/* Étape 2 : code + nouveau mot de passe */}\n      {step === \"reset\" && (\n        <>\n          <label>Code reçu par email</label>\n          <input\n            type=\"text\"\n            value={code}\n            onChange={(e) => setCode(e.target.value)}\n            placeholder=\"Entrez le code reçu\"\n            required\n          />\n\n          <label>Nouveau mot de passe</label>\n          <input\n            type=\"password\"\n            value={newPassword}\n            onChange={(e) => setNewPassword(e.target.value)}\n            required\n          />\n\n          <label>Confirmer mot de passe</label>\n          <input\n            type=\"password\"\n            value={confirmPassword}\n            onChange={(e) => setConfirmPassword(e.target.value)}\n            required\n          />\n        </>\n      )}\n\n      <button\n        type=\"submit\"\n        disabled={loading}\n        style={{ marginTop: \"1rem\", width: \"100%\" }}\n      >\n        {loading\n          ? \"En cours...\"\n          : step === \"request\"\n          ? \"Envoyer le code\"\n          : \"Réinitialiser le mot de passe\"}\n      </button>\n\n      {onCancel && (\n        <button\n          type=\"button\"\n          onClick={onCancel}\n          style={{\n            marginTop: \"0.5rem\",\n            width: \"100%\",\n            backgroundColor: \"#ccc\",\n            color: \"#000\",\n            padding: \"0.5rem\",\n            borderRadius: \"8px\"\n          }}\n        >\n          Retour à la connexion\n        </button>\n      )}\n    </form>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}