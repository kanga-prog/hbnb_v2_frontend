{"ast":null,"code":"var _jsxFileName = \"/home/kanga_prog_unix/hbnb_v2/frontend/src/pages/EditPlace.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport API from \"../services/api\";\nimport PlaceForm from \"../components/place/PlaceForm\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function EditPlace() {\n  _s();\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const [place, setPlace] = useState(null);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    API.get(`/places/${id}/`).then(res => {\n      setPlace(res.data); // passe directement l'objet\n    }).catch(err => {\n      console.error(\"Erreur chargement lieu:\", err);\n      alert(\"Impossible de charger le lieu.\");\n    }).finally(() => setLoading(false));\n  }, [id]);\n  const handleUpdate = async data => {\n    try {\n      const formData = new FormData();\n\n      // Champs texte / numériques\n      for (const key of [\"name\", \"description\", \"price_by_night\", \"location\", \"country\", \"town\", \"latitude\", \"longitude\"]) {\n        if (data[key] !== undefined) formData.append(key, data[key]);\n      }\n\n      // Amenities\n      if (data.amenities) {\n        data.amenities.forEach(a => formData.append(\"amenity_ids\", a));\n      }\n\n      // Nouvelles images\n      if (data.images && data.images.length > 0) {\n        data.images.forEach(file => formData.append(\"files\", file));\n      }\n\n      // Existing images si backend nécessite\n      if (data.existingImages) {\n        data.existingImages.forEach(img => formData.append(\"existing_images\", img.url || img));\n      }\n      await API.put(`/places/${id}/`, data); // ou formData si ton backend accepte multipart\n\n      alert(\"Lieu mis à jour !\");\n      navigate(`/places/${id}`);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(\"Erreur mise à jour :\", err);\n      alert(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || \"Erreur lors de la mise à jour\");\n    }\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Chargement...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 23\n  }, this);\n  if (!place) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Lieu introuvable.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 22\n  }, this);\n  return /*#__PURE__*/_jsxDEV(PlaceForm, {\n    onSubmit: handleUpdate,\n    initialData: place\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 10\n  }, this);\n}\n_s(EditPlace, \"SkxWHHP90eT/JfAfkn7eKzmpEcc=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = EditPlace;\nvar _c;\n$RefreshReg$(_c, \"EditPlace\");","map":{"version":3,"names":["useEffect","useState","useParams","useNavigate","API","PlaceForm","jsxDEV","_jsxDEV","EditPlace","_s","id","navigate","place","setPlace","loading","setLoading","get","then","res","data","catch","err","console","error","alert","finally","handleUpdate","formData","FormData","key","undefined","append","amenities","forEach","a","images","length","file","existingImages","img","url","put","_err$response","_err$response$data","response","message","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","initialData","_c","$RefreshReg$"],"sources":["/home/kanga_prog_unix/hbnb_v2/frontend/src/pages/EditPlace.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport API from \"../services/api\";\nimport PlaceForm from \"../components/place/PlaceForm\";\n\nexport default function EditPlace() {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [place, setPlace] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    API.get(`/places/${id}/`)\n      .then((res) => {\n        setPlace(res.data); // passe directement l'objet\n      })\n      .catch((err) => {\n        console.error(\"Erreur chargement lieu:\", err);\n        alert(\"Impossible de charger le lieu.\");\n      })\n      .finally(() => setLoading(false));\n  }, [id]);\n\n  const handleUpdate = async (data) => {\n    try {\n      const formData = new FormData();\n\n      // Champs texte / numériques\n      for (const key of [\n        \"name\",\n        \"description\",\n        \"price_by_night\",\n        \"location\",\n        \"country\",\n        \"town\",\n        \"latitude\",\n        \"longitude\",\n      ]) {\n        if (data[key] !== undefined) formData.append(key, data[key]);\n      }\n\n      // Amenities\n      if (data.amenities) {\n        data.amenities.forEach((a) => formData.append(\"amenity_ids\", a));\n      }\n\n      // Nouvelles images\n      if (data.images && data.images.length > 0) {\n        data.images.forEach((file) => formData.append(\"files\", file));\n      }\n\n      // Existing images si backend nécessite\n      if (data.existingImages) {\n        data.existingImages.forEach((img) =>\n          formData.append(\"existing_images\", img.url || img)\n        );\n      }\n\n      await API.put(`/places/${id}/`, data); // ou formData si ton backend accepte multipart\n\n      alert(\"Lieu mis à jour !\");\n      navigate(`/places/${id}`);\n    } catch (err) {\n      console.error(\"Erreur mise à jour :\", err);\n      alert(err.response?.data?.message || \"Erreur lors de la mise à jour\");\n    }\n  };\n\n  if (loading) return <p>Chargement...</p>;\n  if (!place) return <p>Lieu introuvable.</p>;\n\n  return <PlaceForm onSubmit={handleUpdate} initialData={place} />;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}