{"ast":null,"code":"var _jsxFileName = \"/home/kanga_prog_unix/hbnb_v2/frontend/src/pages/EditPlace.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport API from \"../services/api\";\nimport PlaceForm from \"../components/place/PlaceForm\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function EditPlace() {\n  _s();\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const [place, setPlace] = useState(null);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    API.get(`/places/${id}/`).then(res => setPlace(res.data)).catch(err => {\n      console.error(err);\n      alert(\"Impossible de charger le lieu.\");\n    }).finally(() => setLoading(false));\n  }, [id]);\n  const handleUpdate = async data => {\n    try {\n      // Préparer FormData pour les fichiers\n      const formData = new FormData();\n      Object.keys(data).forEach(key => {\n        if ([\"name\", \"description\", \"price_by_night\", \"location\", \"country\", \"town\", \"latitude\", \"longitude\"].includes(key)) formData.append(key, data[key]);\n      });\n\n      // Amenities\n      if (data.amenities) data.amenities.forEach(a => formData.append(\"amenity_ids\", a));\n\n      // Nouvelles images\n      if (data.images && data.images.length > 0) {\n        data.images.forEach(file => formData.append(\"files\", file));\n      }\n      await API.put(`/places/${id}/`, formData, {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      });\n      alert(\"Lieu mis à jour !\");\n      navigate(`/places/${id}`);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(err);\n      alert(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || \"Erreur lors de la mise à jour\");\n    }\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Chargement...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 23\n  }, this);\n  if (!place) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Lieu introuvable.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 22\n  }, this);\n  return /*#__PURE__*/_jsxDEV(PlaceForm, {\n    onSubmit: handleUpdate,\n    initialData: place\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 10\n  }, this);\n}\n_s(EditPlace, \"SkxWHHP90eT/JfAfkn7eKzmpEcc=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = EditPlace;\nvar _c;\n$RefreshReg$(_c, \"EditPlace\");","map":{"version":3,"names":["useEffect","useState","useParams","useNavigate","API","PlaceForm","jsxDEV","_jsxDEV","EditPlace","_s","id","navigate","place","setPlace","loading","setLoading","get","then","res","data","catch","err","console","error","alert","finally","handleUpdate","formData","FormData","Object","keys","forEach","key","includes","append","amenities","a","images","length","file","put","headers","_err$response","_err$response$data","response","message","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","initialData","_c","$RefreshReg$"],"sources":["/home/kanga_prog_unix/hbnb_v2/frontend/src/pages/EditPlace.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport API from \"../services/api\";\nimport PlaceForm from \"../components/place/PlaceForm\";\n\nexport default function EditPlace() {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [place, setPlace] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    API.get(`/places/${id}/`)\n      .then((res) => setPlace(res.data))\n      .catch((err) => {\n        console.error(err);\n        alert(\"Impossible de charger le lieu.\");\n      })\n      .finally(() => setLoading(false));\n  }, [id]);\n\n  const handleUpdate = async (data) => {\n    try {\n      // Préparer FormData pour les fichiers\n      const formData = new FormData();\n      Object.keys(data).forEach((key) => {\n        if ([\"name\",\"description\",\"price_by_night\",\"location\",\"country\",\"town\",\"latitude\",\"longitude\"].includes(key))\n          formData.append(key, data[key]);\n      });\n\n      // Amenities\n      if (data.amenities) data.amenities.forEach((a) => formData.append(\"amenity_ids\", a));\n\n      // Nouvelles images\n      if (data.images && data.images.length > 0) {\n        data.images.forEach((file) => formData.append(\"files\", file));\n      }\n\n      await API.put(`/places/${id}/`, formData, {\n        headers: { \"Content-Type\": \"multipart/form-data\" },\n      });\n\n      alert(\"Lieu mis à jour !\");\n      navigate(`/places/${id}`);\n    } catch (err) {\n      console.error(err);\n      alert(err.response?.data?.message || \"Erreur lors de la mise à jour\");\n    }\n  };\n\n  if (loading) return <p>Chargement...</p>;\n  if (!place) return <p>Lieu introuvable.</p>;\n\n  return <PlaceForm onSubmit={handleUpdate} initialData={place} />;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}