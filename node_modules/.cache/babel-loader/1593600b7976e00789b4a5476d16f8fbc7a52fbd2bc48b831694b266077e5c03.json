{"ast":null,"code":"import { jwtDecode } from \"jwt-decode\";\nexport function saveToken(token) {\n  localStorage.setItem(\"token\", token);\n}\nexport function getToken() {\n  return localStorage.getItem(\"token\");\n}\nexport function logout() {\n  localStorage.removeItem(\"token\");\n}\nexport function getCurrentUser() {\n  const token = getToken();\n  if (!token) return null;\n  try {\n    var _decoded$sub;\n    const decoded = jwtDecode(token);\n    return {\n      id: ((_decoded$sub = decoded.sub) === null || _decoded$sub === void 0 ? void 0 : _decoded$sub.toString()) || \"\",\n      // l’ID vient de `identity`\n      username: decoded.username || \"\",\n      // injecté via `additional_claims`\n      is_admin: !!decoded.is_admin // idem\n    };\n  } catch (err) {\n    console.error(\"Erreur décodage JWT :\", err);\n    return null;\n  }\n}","map":{"version":3,"names":["jwtDecode","saveToken","token","localStorage","setItem","getToken","getItem","logout","removeItem","getCurrentUser","_decoded$sub","decoded","id","sub","toString","username","is_admin","err","console","error"],"sources":["/home/kanga_prog_unix/hbnb_v2/frontend/src/utils/auth.js"],"sourcesContent":["import { jwtDecode } from \"jwt-decode\";\n\nexport function saveToken(token) {\n  localStorage.setItem(\"token\", token);\n}\n\nexport function getToken() {\n  return localStorage.getItem(\"token\");\n}\n\nexport function logout() {\n  localStorage.removeItem(\"token\");\n}\n\nexport function getCurrentUser() {\n  const token = getToken();\n  if (!token) return null;\n\n  try {\n    const decoded = jwtDecode(token);\n\n    return {\n      id: decoded.sub?.toString() || \"\",   // l’ID vient de `identity`\n      username: decoded.username || \"\",    // injecté via `additional_claims`\n      is_admin: !!decoded.is_admin,        // idem\n    };\n  } catch (err) {\n    console.error(\"Erreur décodage JWT :\", err);\n    return null;\n  }\n}\n"],"mappings":"AAAA,SAASA,SAAS,QAAQ,YAAY;AAEtC,OAAO,SAASC,SAASA,CAACC,KAAK,EAAE;EAC/BC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,KAAK,CAAC;AACtC;AAEA,OAAO,SAASG,QAAQA,CAAA,EAAG;EACzB,OAAOF,YAAY,CAACG,OAAO,CAAC,OAAO,CAAC;AACtC;AAEA,OAAO,SAASC,MAAMA,CAAA,EAAG;EACvBJ,YAAY,CAACK,UAAU,CAAC,OAAO,CAAC;AAClC;AAEA,OAAO,SAASC,cAAcA,CAAA,EAAG;EAC/B,MAAMP,KAAK,GAAGG,QAAQ,CAAC,CAAC;EACxB,IAAI,CAACH,KAAK,EAAE,OAAO,IAAI;EAEvB,IAAI;IAAA,IAAAQ,YAAA;IACF,MAAMC,OAAO,GAAGX,SAAS,CAACE,KAAK,CAAC;IAEhC,OAAO;MACLU,EAAE,EAAE,EAAAF,YAAA,GAAAC,OAAO,CAACE,GAAG,cAAAH,YAAA,uBAAXA,YAAA,CAAaI,QAAQ,CAAC,CAAC,KAAI,EAAE;MAAI;MACrCC,QAAQ,EAAEJ,OAAO,CAACI,QAAQ,IAAI,EAAE;MAAK;MACrCC,QAAQ,EAAE,CAAC,CAACL,OAAO,CAACK,QAAQ,CAAS;IACvC,CAAC;EACH,CAAC,CAAC,OAAOC,GAAG,EAAE;IACZC,OAAO,CAACC,KAAK,CAAC,uBAAuB,EAAEF,GAAG,CAAC;IAC3C,OAAO,IAAI;EACb;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}